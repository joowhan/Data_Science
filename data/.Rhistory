train_data$pm2.5_log <- log10(train_data$pm2.5)
## training data
sv_reg_month_log <- tapply(train_data$pm2.5_log, train_data$month, mean)
##training
train_data$pred_pm2.5_log <- sv_reg_month_log[train_data$month]
# head(train_data[,c('month', 'pred_pm2.5_log', 'pm2.5_log', 'pm2.5')])
train_data$error_log <- train_data$pm2.5_log - train_data$pred_pm2.5_log
##not log
sv_reg_month <- tapply(train_data$pm2.5, train_data$month, mean)
train_data$pred_pm2.5 <- sv_reg_month[train_data$month]
#head(train_data[,c('month', 'pred_pm2.5_log', 'pm2.5')])
train_data$error <- train_data$pm2.5 - train_data$pred_pm2.5
head(train_data[,c('month', 'pm2.5', 'pred_pm2.5', 'error')], 10)
##MSE and RMSE, not log
MSE_train <- round(mean(train_data$error ** 2),3)
RMSE_train <- round(sqrt(MSE_train),3)
## MSE and RMSE fort test, not log
test_data$pred_pm2.5 <- sv_reg_month[test_data$month]
test_data$error <- test_data$pm2.5 - test_data$pred_pm2.5
#head(test_data[,c('month', 'pm2.5', 'pred_pm2.5', 'error')], 10)
MSE_test <- round(mean(test_data$error ** 2),3)
RMSE_test <- round(sqrt(MSE_test),3)
paste("train data: (MSE ", MSE_train,") (RMSE",RMSE_train, ")", sep=" ")
paste("test data: (MSE ", MSE_test,") (RMSE",RMSE_test, ")", sep=" ")
#**log version**#
## MSE and RMSE fort test, using log
MSE_train_log <- round(mean(train_data$error ** 2),3)
RMSE_train_log <- round(sqrt(MSE_train),3)
## MSE and RMSE fort test, not log
test_data$pred_pm2.5_log <- sv_reg_month[test_data$month]
test_data$error_log <- test_data$pm2.5 - test_data$pred_pm2.5
#head(test_data[,c('month', 'pm2.5', 'pred_pm2.5', 'error')], 10)
MSE_test_log <- round(mean(test_data$error_log ** 2),3)
RMSE_test_log <- round(sqrt(MSE_test_log),3)
# paste("train data: (MSE ", MSE_train_log,") (RMSE",RMSE_train_log, ")", sep=" ")
# paste("test data: (MSE ", MSE_test_log,") (RMSE",RMSE_test_log, ")", sep=" ")
RSS <- sum(train_data$error **2)
RSS
SStot <- sum((train_data$pm2.5 - mean(train_data$pm2.5))**2)
Rsq_train <- round(1- RSS/SStot,3)
Rsq_train
paste("R2 for train data:", Rsq_train)
RSS  <- sum(test_data$error **2)
SStot <- sum((test_data$pm2.5 - mean(test_data$pm2.5))**2)
Rsq_test <- round(1- RSS/SStot,3)
paste("R2 for test data:", Rsq_test)
#*log version*#
RSS <- sum(train_data$error_log **2)
RSS
SStot <- sum((train_data$pm2.5_log - mean(train_data$pm2.5_log))**2)
Rsq_train <- round(1- RSS/SStot,3)
Rsq_train
paste("R2 for train data:", Rsq_train)
RSS  <- sum(test_data$error_log **2)
SStot <- sum((test_data$pm2.5_log - mean(test_data$pm2.5_log))**2)
Rsq_test <- round(1- RSS/SStot,3)
paste("R2 for test data:", Rsq_test)
table(train_data$hour)
# train_data$hour_group <- cut(train_data$hour, breaks = c(0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,18,19,20,21,22,23), include.lowest = T)
train_data$hour_group <- cut(train_data$hour, breaks = c(0,3,6,9,12,15,18,21,23), include.lowest = T)
#levels(train_data$hour_group) <- c('midnight', 'morning', 'afternoon', 'night')
sv_reg_hour <- tapply(train_data$pm2.5, train_data$hour_group, mean)
train_data$pred_pm2.5_hour <- (sv_reg_hour[train_data$hour_group])
train_data$error <- train_data$pm2.5 - train_data$pred_pm2.5_hour
head(train_data[,c('month', 'pm2.5', 'pred_pm2.5_hour', 'error')], 10)
MSE_train <- round(mean(train_data$error ** 2),3)
RMSE_train <- round(sqrt(MSE_train),3)
test_data$pred_pm2.5_hour <- sv_reg_month[test_data$month]
test_data$error <- test_data$pm2.5 - test_data$pred_pm2.5_hour
MSE_test <- round(mean(test_data$error ** 2),3)
RMSE_test <- round(sqrt(MSE_test),3)
paste("train data: (MSE ", MSE_train,") (RMSE",RMSE_train, ")", sep=" ")
paste("test data: (MSE ", MSE_test,") (RMSE",RMSE_test, ")", sep=" ")
##Rsq
RSS <- sum(train_data$error **2)
RSS
SStot <- sum((train_data$pm2.5 - mean(train_data$pm2.5))**2)
Rsq_train <- round(1- RSS/SStot,3)
Rsq_train
paste("R2 for train data:", Rsq_train)
RSS  <- sum(test_data$error **2)
SStot <- sum((test_data$pm2.5 - mean(test_data$pm2.5))**2)
Rsq_test <- round(1- RSS/SStot,3)
paste("R2 for test data:", Rsq_test)
table(train_data$DEWP)
hist(train_data$DEWP)
summary(train_data$DEWP)
# train_data$hour_group <- cut(train_data$hour, breaks = c(0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,18,19,20,21,22,23), include.lowest = T)
train_data$DWEP_group <- cut(train_data$DWEP, breaks = c(-33,-11,1,15,28), include.lowest = T)
table(train_data$DEWP)
hist(train_data$DEWP)
summary(train_data$DEWP)
# train_data$hour_group <- cut(train_data$hour, breaks = c(0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,18,19,20,21,22,23), include.lowest = T)
train_data$DWEP_group <- cut(train_data$DWEP, breaks = c(-33,-11,1,15,28), include.lowest = T)
table(train_data$hour)
# train_data$hour_group <- cut(train_data$hour, breaks = c(0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,18,19,20,21,22,23), include.lowest = T)
train_data$hour_group <- cut(train_data$hour, breaks = c(0,3,6,9,12,15,18,21,23), include.lowest = T)
#levels(train_data$hour_group) <- c('midnight', 'morning', 'afternoon', 'night')
sv_reg_hour <- tapply(train_data$pm2.5, train_data$hour_group, mean)
train_data$pred_pm2.5_hour <- (sv_reg_hour[train_data$hour_group])
train_data$error <- train_data$pm2.5 - train_data$pred_pm2.5_hour
head(train_data[,c('month', 'pm2.5', 'pred_pm2.5_hour', 'error')], 10)
MSE_train <- round(mean(train_data$error ** 2),3)
RMSE_train <- round(sqrt(MSE_train),3)
test_data$pred_pm2.5_hour <- sv_reg_DWEP[test_data$month]
table(train_data$hour)
# train_data$hour_group <- cut(train_data$hour, breaks = c(0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,18,19,20,21,22,23), include.lowest = T)
train_data$hour_group <- cut(train_data$hour, breaks = c(0,3,6,9,12,15,18,21,23), include.lowest = T)
#levels(train_data$hour_group) <- c('midnight', 'morning', 'afternoon', 'night')
sv_reg_hour <- tapply(train_data$pm2.5, train_data$hour_group, mean)
train_data$pred_pm2.5_hour <- (sv_reg_hour[train_data$hour_group])
train_data$error <- train_data$pm2.5 - train_data$pred_pm2.5_hour
head(train_data[,c('month', 'pm2.5', 'pred_pm2.5_hour', 'error')], 10)
MSE_train <- round(mean(train_data$error ** 2),3)
RMSE_train <- round(sqrt(MSE_train),3)
test_data$pred_pm2.5_hour <- sv_reg_DWEP[test_data$hour_group]
table(train_data$hour)
# train_data$hour_group <- cut(train_data$hour, breaks = c(0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,18,19,20,21,22,23), include.lowest = T)
train_data$hour_group <- cut(train_data$hour, breaks = c(0,3,6,9,12,15,18,21,23), include.lowest = T)
#levels(train_data$hour_group) <- c('midnight', 'morning', 'afternoon', 'night')
sv_reg_hour <- tapply(train_data$pm2.5, train_data$hour_group, mean)
train_data$pred_pm2.5_hour <- (sv_reg_hour[train_data$hour_group])
train_data$error <- train_data$pm2.5 - train_data$pred_pm2.5_hour
head(train_data[,c('month', 'pm2.5', 'pred_pm2.5_hour', 'error')], 10)
MSE_train <- round(mean(train_data$error ** 2),3)
RMSE_train <- round(sqrt(MSE_train),3)
test_data$pred_pm2.5_hour <- sv_reg_hour[test_data$hour_group]
table(train_data$hour)
# train_data$hour_group <- cut(train_data$hour, breaks = c(0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,18,19,20,21,22,23), include.lowest = T)
train_data$hour_group <- cut(train_data$hour, breaks = c(0,3,6,9,12,15,18,21,23), include.lowest = T)
#levels(train_data$hour_group) <- c('midnight', 'morning', 'afternoon', 'night')
sv_reg_hour <- tapply(train_data$pm2.5, train_data$hour_group, mean)
train_data$pred_pm2.5_hour <- (sv_reg_hour[train_data$hour_group])
train_data$error <- train_data$pm2.5 - train_data$pred_pm2.5_hour
head(train_data[,c('month', 'pm2.5', 'pred_pm2.5_hour', 'error')], 10)
MSE_train <- round(mean(train_data$error ** 2),3)
RMSE_train <- round(sqrt(MSE_train),3)
test_data$hour_group <- cut(test_data$hour, breaks = c(0,3,6,9,12,15,18,21,23), include.lowest = T)
test_data$pred_pm2.5_hour <- sv_reg_hour[test_data$hour_group]
test_data$error <- test_data$pm2.5 - test_data$pred_pm2.5_hour
MSE_test <- round(mean(test_data$error ** 2),3)
RMSE_test <- round(sqrt(MSE_test),3)
paste("train data: (MSE ", MSE_train,") (RMSE",RMSE_train, ")", sep=" ")
paste("test data: (MSE ", MSE_test,") (RMSE",RMSE_test, ")", sep=" ")
##Rsq
RSS <- sum(train_data$error **2)
RSS
SStot <- sum((train_data$pm2.5 - mean(train_data$pm2.5))**2)
Rsq_train <- round(1- RSS/SStot,3)
Rsq_train
paste("R2 for train data:", Rsq_train)
RSS  <- sum(test_data$error **2)
SStot <- sum((test_data$pm2.5 - mean(test_data$pm2.5))**2)
Rsq_test <- round(1- RSS/SStot,3)
paste("R2 for test data:", Rsq_test)
train_data$DWEP_group <- cut(train_data$DWEP, breaks = c(-33,-11,1,15,28), include.lowest = T)
# train_data$hour_group <- cut(train_data$hour, breaks = c(0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,18,19,20,21,22,23), include.lowest = T)
train_data$DWEP_group <- cut(train_data$DWEP, breaks = c(-33,-11,1,15,28), include.lowest = T, right=F)
# train_data$hour_group <- cut(train_data$hour, breaks = c(0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,18,19,20,21,22,23), include.lowest = T)
train_data$DWEP_group <- cut(train_data$DWEP, breaks = c(-33,-11,0,15,28), include.lowest = T, right=F)
#levels(train_data$hour_group) <- c('midnight', 'morning', 'afternoon', 'night')
sv_reg_DWEP <- tapply(train_data$pm2.5, train_data$DWEP_group, mean)
train_data$pred_pm2.5_DWEP <- (sv_reg_DWEP[train_data$DWEP_group])
train_data$DWEP_group <- cut(train_data$DWEP, breaks = c(-33,-11,0,15,28), include.lowest = T, right=F)
table(train_data$DEWP)
hist(train_data$DEWP)
summary(train_data$DEWP)
# train_data$hour_group <- cut(train_data$hour, breaks = c(0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,18,19,20,21,22,23), include.lowest = T)
train_data$DWEP_group <- cut(train_data$DWEP, breaks = c(-33,-11,1,15,33), include.lowest = T, right=F)
table(train_data$DEWP)
hist(train_data$DEWP)
summary(train_data$DEWP)
# train_data$hour_group <- cut(train_data$hour, breaks = c(0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,18,19,20,21,22,23), include.lowest = T)
train_data$DWEP_group <- cut(train_data$DWEP, breaks = c(-33,-20,-10,0,10,20,33), include.lowest = T, right=F)
table(train_data$DEWP)
hist(train_data$DEWP)
summary(train_data$DEWP)
# train_data$hour_group <- cut(train_data$hour, breaks = c(0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,18,19,20,21,22,23), include.lowest = T)
train_data$DWEP_group <- cut(train_data$DWEP, breaks = c(-Inf,-20,-10,0,10,20,Inf), include.lowest = T, right=F)
table(train_data$DEWP)
hist(train_data$DEWP)
summary(train_data$DEWP)
# train_data$hour_group <- cut(train_data$hour, breaks = c(0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,18,19,20,21,22,23), include.lowest = T)
train_data$DEWP_group <- cut(train_data$DEWP, breaks = c(-Inf,-20,-10,0,10,20,Inf), include.lowest = T, right=F)
#levels(train_data$hour_group) <- c('midnight', 'morning', 'afternoon', 'night')
sv_reg_DWEP <- tapply(train_data$pm2.5, train_data$DWEP_group, mean)
table(train_data$DEWP)
hist(train_data$DEWP)
summary(train_data$DEWP)
# train_data$hour_group <- cut(train_data$hour, breaks = c(0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,18,19,20,21,22,23), include.lowest = T)
train_data$DEWP_group <- cut(train_data$DEWP, breaks = c(-Inf,-20,-10,0,10,20,Inf), include.lowest = T, right=F)
#levels(train_data$hour_group) <- c('midnight', 'morning', 'afternoon', 'night')
sv_reg_DEWP <- tapply(train_data$pm2.5, train_data$DEWP_group, mean)
train_data$pred_pm2.5_DEWP <- (sv_reg_DEWP[train_data$DEWP_group])
train_data$error <- train_data$pm2.5 - train_data$pred_pm2.5_DEWP
head(train_data[,c('month', 'pm2.5', 'pred_pm2.5_DEWP', 'error')], 10)
test_data$DEWP_group <- cut(test_data$DEWP, breaks = c(-Inf,-20,-10,0,10,20,Inf), include.lowest = T, right=F)
test_data$pred_pm2.5_DEWP <- sv_reg_DEWP[test_data$DEWP_group]
test_data$error <- test_data$pm2.5 - test_data$pred_pm2.5_DEWP
paste("train data: (MSE ", MSE_train,") (RMSE",RMSE_train, ")", sep=" ")
paste("test data: (MSE ", MSE_test,") (RMSE",RMSE_test, ")", sep=" ")
##Rsq
RSS <- sum(train_data$error **2)
RSS
SStot <- sum((train_data$pm2.5 - mean(train_data$pm2.5))**2)
Rsq_train <- round(1- RSS/SStot,3)
Rsq_train
paste("R2 for train data:", Rsq_train)
RSS  <- sum(test_data$error **2)
SStot <- sum((test_data$pm2.5 - mean(test_data$pm2.5))**2)
Rsq_test <- round(1- RSS/SStot,3)
paste("R2 for test data:", Rsq_test)
table(train_data$DEWP)
hist(train_data$DEWP)
summary(train_data$DEWP)
train_data$DEWP_group <- cut(train_data$DEWP, breaks = c(-Inf,0,13,16,18,21,24,Inf), include.lowest = T, right=F)
sv_reg_DEWP <- tapply(train_data$pm2.5, train_data$DEWP_group, mean)
train_data$pred_pm2.5_DEWP <- (sv_reg_DEWP[train_data$DEWP_group])
train_data$error <- train_data$pm2.5 - train_data$pred_pm2.5_DEWP
head(train_data[,c('month', 'pm2.5', 'pred_pm2.5_DEWP', 'error')], 10)
MSE_train <- round(mean(train_data$error ** 2),3)
RMSE_train <- round(sqrt(MSE_train),3)
test_data$DEWP_group <- cut(test_data$DEWP, breaks = c(-Inf,-20,-10,0,10,20,Inf), include.lowest = T, right=F)
test_data$pred_pm2.5_DEWP <- sv_reg_DEWP[test_data$DEWP_group]
test_data$error <- test_data$pm2.5 - test_data$pred_pm2.5_DEWP
MSE_test <- round(mean(test_data$error ** 2),3)
RMSE_test <- round(sqrt(MSE_test),3)
paste("train data: (MSE ", MSE_train,") (RMSE",RMSE_train, ")", sep=" ")
paste("test data: (MSE ", MSE_test,") (RMSE",RMSE_test, ")", sep=" ")
##Rsq
RSS <- sum(train_data$error **2)
RSS
SStot <- sum((train_data$pm2.5 - mean(train_data$pm2.5))**2)
Rsq_train <- round(1- RSS/SStot,3)
Rsq_train
paste("R2 for train data:", Rsq_train)
RSS  <- sum(test_data$error **2)
SStot <- sum((test_data$pm2.5 - mean(test_data$pm2.5))**2)
Rsq_test <- round(1- RSS/SStot,3)
paste("R2 for test data:", Rsq_test)
table(train_data$DEWP)
hist(train_data$DEWP)
summary(train_data$DEWP)
#train_data$DEWP_group <- cut(train_data$DEWP, breaks = c(-Inf,0,13,16,18,21,24,Inf), include.lowest = T, right=F)
train_data$DEWP_group <- cut(train_data$DEWP, breaks = c(-Inf,-20,-10,0,10,20,Inf), include.lowest = T, right=F)
sv_reg_DEWP <- tapply(train_data$pm2.5, train_data$DEWP_group, mean)
train_data$pred_pm2.5_DEWP <- (sv_reg_DEWP[train_data$DEWP_group])
train_data$error <- train_data$pm2.5 - train_data$pred_pm2.5_DEWP
head(train_data[,c('month', 'pm2.5', 'pred_pm2.5_DEWP', 'error')], 10)
MSE_train <- round(mean(train_data$error ** 2),3)
RMSE_train <- round(sqrt(MSE_train),3)
test_data$DEWP_group <- cut(test_data$DEWP, breaks = c(-Inf,-20,-10,0,10,20,Inf), include.lowest = T, right=F)
test_data$pred_pm2.5_DEWP <- sv_reg_DEWP[test_data$DEWP_group]
test_data$error <- test_data$pm2.5 - test_data$pred_pm2.5_DEWP
MSE_test <- round(mean(test_data$error ** 2),3)
RMSE_test <- round(sqrt(MSE_test),3)
paste("train data: (MSE ", MSE_train,") (RMSE",RMSE_train, ")", sep=" ")
paste("test data: (MSE ", MSE_test,") (RMSE",RMSE_test, ")", sep=" ")
##Rsq
RSS <- sum(train_data$error **2)
RSS
SStot <- sum((train_data$pm2.5 - mean(train_data$pm2.5))**2)
Rsq_train <- round(1- RSS/SStot,3)
Rsq_train
paste("R2 for train data:", Rsq_train)
RSS  <- sum(test_data$error **2)
SStot <- sum((test_data$pm2.5 - mean(test_data$pm2.5))**2)
Rsq_test <- round(1- RSS/SStot,3)
paste("R2 for test data:", Rsq_test)
table(train_data$DEWP)
hist(train_data$DEWP)
summary(train_data$DEWP)
train_data$DEWP_group <- cut(train_data$DEWP, breaks = c(-Inf,0,13,16,18,21,24,Inf), include.lowest = T, right=F)
#train_data$DEWP_group <- cut(train_data$DEWP, breaks = c(-Inf,-20,-10,0,10,20,Inf), include.lowest = T, right=F)
sv_reg_DEWP <- tapply(train_data$pm2.5, train_data$DEWP_group, mean)
train_data$pred_pm2.5_DEWP <- (sv_reg_DEWP[train_data$DEWP_group])
train_data$error <- train_data$pm2.5 - train_data$pred_pm2.5_DEWP
head(train_data[,c('month', 'pm2.5', 'pred_pm2.5_DEWP', 'error')], 10)
MSE_train <- round(mean(train_data$error ** 2),3)
RMSE_train <- round(sqrt(MSE_train),3)
test_data$DEWP_group <- cut(test_data$DEWP, breaks = c(-Inf,0,13,16,18,21,24,Inf), include.lowest = T, right=F)
#test_data$DEWP_group <- cut(test_data$DEWP, breaks = c(-Inf,-20,-10,0,10,20,Inf), include.lowest = T, right=F)
test_data$pred_pm2.5_DEWP <- sv_reg_DEWP[test_data$DEWP_group]
test_data$error <- test_data$pm2.5 - test_data$pred_pm2.5_DEWP
MSE_test <- round(mean(test_data$error ** 2),3)
RMSE_test <- round(sqrt(MSE_test),3)
paste("train data: (MSE ", MSE_train,") (RMSE",RMSE_train, ")", sep=" ")
paste("test data: (MSE ", MSE_test,") (RMSE",RMSE_test, ")", sep=" ")
##Rsq
RSS <- sum(train_data$error **2)
RSS
SStot <- sum((train_data$pm2.5 - mean(train_data$pm2.5))**2)
Rsq_train <- round(1- RSS/SStot,3)
Rsq_train
paste("R2 for train data:", Rsq_train)
RSS  <- sum(test_data$error **2)
SStot <- sum((test_data$pm2.5 - mean(test_data$pm2.5))**2)
Rsq_test <- round(1- RSS/SStot,3)
paste("R2 for test data:", Rsq_test)
RSS/SStot
table(train_data$DEWP)
hist(train_data$DEWP)
summary(train_data$DEWP)
# train_data$DEWP_group <- cut(train_data$DEWP, breaks = c(-Inf,0,13,16,18,21,24,Inf), include.lowest = T, right=F)
train_data$DEWP_group <- cut(train_data$DEWP, breaks = c(-Inf,-20,-10,0,10,20,Inf), include.lowest = T, right=F)
sv_reg_DEWP <- tapply(train_data$pm2.5, train_data$DEWP_group, mean)
train_data$pred_pm2.5_DEWP <- (sv_reg_DEWP[train_data$DEWP_group])
train_data$error <- train_data$pm2.5 - train_data$pred_pm2.5_DEWP
head(train_data[,c('month', 'pm2.5', 'pred_pm2.5_DEWP', 'error')], 10)
MSE_train <- round(mean(train_data$error ** 2),3)
RMSE_train <- round(sqrt(MSE_train),3)
# test_data$DEWP_group <- cut(test_data$DEWP, breaks = c(-Inf,0,13,16,18,21,24,Inf), include.lowest = T, right=F)
test_data$DEWP_group <- cut(test_data$DEWP, breaks = c(-Inf,-20,-10,0,10,20,Inf), include.lowest = T, right=F)
test_data$pred_pm2.5_DEWP <- sv_reg_DEWP[test_data$DEWP_group]
test_data$error <- test_data$pm2.5 - test_data$pred_pm2.5_DEWP
MSE_test <- round(mean(test_data$error ** 2),3)
RMSE_test <- round(sqrt(MSE_test),3)
paste("train data: (MSE ", MSE_train,") (RMSE",RMSE_train, ")", sep=" ")
paste("test data: (MSE ", MSE_test,") (RMSE",RMSE_test, ")", sep=" ")
##Rsq
RSS <- sum(train_data$error **2)
RSS
SStot <- sum((train_data$pm2.5 - mean(train_data$pm2.5))**2)
Rsq_train <- round(1- RSS/SStot,3)
Rsq_train
paste("R2 for train data:", Rsq_train)
RSS  <- sum(test_data$error **2)
SStot <- sum((test_data$pm2.5 - mean(test_data$pm2.5))**2)
Rsq_test <- round(1- RSS/SStot,3)
paste("R2 for test data:", Rsq_test)
hist(train_data$DEWP)
table(train_data$DEWP)
hist(train_data$DEWP)
summary(train_data$DEWP)
train_data$DEWP_group <- cut(train_data$DEWP, breaks = c(-Inf,0,13,16,18,21,24,Inf), include.lowest = T, right=F)
# train_data$DEWP_group <- cut(train_data$DEWP, breaks = c(-Inf,-20,-10,0,10,20,Inf), include.lowest = T, right=F)
sv_reg_DEWP <- tapply(train_data$pm2.5, train_data$DEWP_group, mean)
train_data$pred_pm2.5_DEWP <- (sv_reg_DEWP[train_data$DEWP_group])
train_data$error <- train_data$pm2.5 - train_data$pred_pm2.5_DEWP
head(train_data[,c('month', 'pm2.5', 'pred_pm2.5_DEWP', 'error')], 10)
MSE_train <- round(mean(train_data$error ** 2),3)
RMSE_train <- round(sqrt(MSE_train),3)
test_data$DEWP_group <- cut(test_data$DEWP, breaks = c(-Inf,0,13,16,18,21,24,Inf), include.lowest = T, right=F)
# test_data$DEWP_group <- cut(test_data$DEWP, breaks = c(-Inf,-20,-10,0,10,20,Inf), include.lowest = T, right=F)
test_data$pred_pm2.5_DEWP <- sv_reg_DEWP[test_data$DEWP_group]
test_data$error <- test_data$pm2.5 - test_data$pred_pm2.5_DEWP
MSE_test <- round(mean(test_data$error ** 2),3)
RMSE_test <- round(sqrt(MSE_test),3)
paste("train data: (MSE ", MSE_train,") (RMSE",RMSE_train, ")", sep=" ")
paste("test data: (MSE ", MSE_test,") (RMSE",RMSE_test, ")", sep=" ")
##Rsq
RSS <- sum(train_data$error **2)
RSS
SStot <- sum((train_data$pm2.5 - mean(train_data$pm2.5))**2)
Rsq_train <- round(1- RSS/SStot,3)
Rsq_train
paste("R2 for train data:", Rsq_train)
RSS  <- sum(test_data$error **2)
SStot <- sum((test_data$pm2.5 - mean(test_data$pm2.5))**2)
Rsq_test <- round(1- RSS/SStot,3)
paste("R2 for test data:", Rsq_test)
table(train_data$DEWP)
hist(train_data$DEWP)
summary(train_data$DEWP)
train_data$DEWP_group <- cut(train_data$DEWP, breaks = c(-Inf,-11,0,13,16,18,21,24,Inf), include.lowest = T, right=F)
# train_data$DEWP_group <- cut(train_data$DEWP, breaks = c(-Inf,-20,-10,0,10,20,Inf), include.lowest = T, right=F)
sv_reg_DEWP <- tapply(train_data$pm2.5, train_data$DEWP_group, mean)
train_data$pred_pm2.5_DEWP <- (sv_reg_DEWP[train_data$DEWP_group])
train_data$error <- train_data$pm2.5 - train_data$pred_pm2.5_DEWP
head(train_data[,c('month', 'pm2.5', 'pred_pm2.5_DEWP', 'error')], 10)
MSE_train <- round(mean(train_data$error ** 2),3)
RMSE_train <- round(sqrt(MSE_train),3)
test_data$DEWP_group <- cut(test_data$DEWP, breaks = c(-Inf,-11,0,13,16,18,21,24,Inf), include.lowest = T, right=F)
# test_data$DEWP_group <- cut(test_data$DEWP, breaks = c(-Inf,-20,-10,0,10,20,Inf), include.lowest = T, right=F)
test_data$pred_pm2.5_DEWP <- sv_reg_DEWP[test_data$DEWP_group]
test_data$error <- test_data$pm2.5 - test_data$pred_pm2.5_DEWP
MSE_test <- round(mean(test_data$error ** 2),3)
RMSE_test <- round(sqrt(MSE_test),3)
paste("train data: (MSE ", MSE_train,") (RMSE",RMSE_train, ")", sep=" ")
paste("test data: (MSE ", MSE_test,") (RMSE",RMSE_test, ")", sep=" ")
##Rsq
RSS <- sum(train_data$error **2)
RSS
SStot <- sum((train_data$pm2.5 - mean(train_data$pm2.5))**2)
Rsq_train <- round(1- RSS/SStot,3)
Rsq_train
paste("R2 for train data:", Rsq_train)
RSS  <- sum(test_data$error **2)
SStot <- sum((test_data$pm2.5 - mean(test_data$pm2.5))**2)
Rsq_test <- round(1- RSS/SStot,3)
paste("R2 for test data:", Rsq_test)
table(train_data$DEWP)
hist(train_data$DEWP)
summary(train_data$DEWP)
train_data$DEWP_group <- cut(train_data$DEWP, breaks = c(-Inf,-11,0,13,16,18,21,24,Inf), include.lowest = T, right=F)
# train_data$DEWP_group <- cut(train_data$DEWP, breaks = c(-Inf,-20,-10,0,10,20,Inf), include.lowest = T, right=F)
levels(train_data$DEWP_group)<-c('bone dry','super dry', 'dry', 'pleasant', 'damp', 'muggy', 'extremely hot', 'nasty')
sv_reg_DEWP <- tapply(train_data$pm2.5, train_data$DEWP_group, mean)
train_data$pred_pm2.5_DEWP <- (sv_reg_DEWP[train_data$DEWP_group])
train_data$error <- train_data$pm2.5 - train_data$pred_pm2.5_DEWP
head(train_data[,c('month', 'pm2.5', 'pred_pm2.5_DEWP', 'error')], 10)
MSE_train <- round(mean(train_data$error ** 2),3)
RMSE_train <- round(sqrt(MSE_train),3)
test_data$DEWP_group <- cut(test_data$DEWP, breaks = c(-Inf,-11,0,13,16,18,21,24,Inf), include.lowest = T, right=F)
# test_data$DEWP_group <- cut(test_data$DEWP, breaks = c(-Inf,-20,-10,0,10,20,Inf), include.lowest = T, right=F)
test_data$pred_pm2.5_DEWP <- sv_reg_DEWP[test_data$DEWP_group]
test_data$error <- test_data$pm2.5 - test_data$pred_pm2.5_DEWP
MSE_test <- round(mean(test_data$error ** 2),3)
RMSE_test <- round(sqrt(MSE_test),3)
paste("train data: (MSE ", MSE_train,") (RMSE",RMSE_train, ")", sep=" ")
paste("test data: (MSE ", MSE_test,") (RMSE",RMSE_test, ")", sep=" ")
##Rsq
RSS <- sum(train_data$error **2)
RSS
SStot <- sum((train_data$pm2.5 - mean(train_data$pm2.5))**2)
Rsq_train <- round(1- RSS/SStot,3)
Rsq_train
paste("R2 for train data:", Rsq_train)
RSS  <- sum(test_data$error **2)
SStot <- sum((test_data$pm2.5 - mean(test_data$pm2.5))**2)
Rsq_test <- round(1- RSS/SStot,3)
paste("R2 for test data:", Rsq_test)
hist(train_data$DEWP)
summary(train_data$DEWP)
var(train_data$pm2.5)
var(train_data$pm2.5)
var(test_data$pm2.5)
prsa <- read.csv('data/PRSA_data.csv')
library(stringr)
prsa <- read.csv('data/PRSA_data.csv')
library(dplyr)
library(tidyr)
library(stringr)
library(lubridate)
library(ROCR)
library(ggplot2)
install.packages(rpart)
library(rpart)
View(prsa)
str(prsa)
glimpse(prsa)
prsa <-prsa[,-1]
prsa <-prsa[,-1]
prsa$bad_air <- ifelse(prsa[prsa$pm2.5,]>75, TRUE, FALSE)
sum(is.na(prsa))
colsums(is.na(prsa))
sum(is.na(prsa))
colSums(is.na(prsa))
prsa <- na.omit(prsa)
prsa$bad_air <- ifelse(prsa[prsa$pm2.5,]>75, TRUE, FALSE)
ifelse(prsa[prsa$pm2.5,]>75, TRUE, FALSE)
str(prsa)
glimpse(prsa)
#remove column
prsa <-prsa[,-1]
sum(is.na(prsa))
colSums(is.na(prsa))
prsa <- na.omit(prsa)
prsa$bad_air <- ifelse(prsa[prsa$pm2.5,]>75, prsa[prsa$pm2.5,] ==TRUE, prsa[prsa$pm2.5,] ==FALSE)
prsa$bad_air <- ifelse(prsa$pm2.5>75, TRUE, FALSE)
##divide into train data and test data
train_data<-subset(prsa, prsa$year<2014)
test_data <- subset(prsa, prsa$year==2014)
num_train <-nrow(train_data)
num_test <-nrow(test_data)
train_data<-subset(prsa, prsa$year<2014)
test_data <- subset(prsa, prsa$year==2014)
## number of sample agter delete NA
num_train <-nrow(train_data)
num_test <-nrow(test_data)
num_test
View(test_data)
subset(prsa, prsa$year<2014)
prsa <- read.csv('data/PRSA_data.csv')
library(dplyr)
library(tidyr)
library(stringr)
library(lubridate)
library(ROCR)
library(ggplot2)
library(rpart)
tr(prsa)
str(prsa)
glimpse(prsa)
#remove column
prsa <-prsa[,-1]
sum(is.na(prsa))
colSums(is.na(prsa))
prsa <- na.omit(prsa)
prsa$bad_air <- ifelse(prsa$pm2.5>75, TRUE, FALSE)
prsa
train_data<-subset(prsa, prsa$year<2014)
test_data <- subset(prsa, prsa$year==2014)
## number of sample agter delete NA
num_train <-nrow(train_data)
num_test <-nrow(test_data)
round(prop.table(table(prsa$year<2014))*100,2)
round(prop.table(table(prsa$year<2014))*100,2)
#draw graph
plot(density(train_data$pm2.5),xlim = c(0,1000), ylim=c(0,0.01))
par(new = TRUE)
lines(density(test_data$pm2.5), col="red")
var(train_data$pm2.5)
var(test_data$pm2.5)
View(train_data)
View(test_data)
#loan_model <p- rpart(pm2.5 ~day+hour+DEWP+TEMP+PRES)
loan_model <p- rpart(pm2.5 ~., data=train_data, method="class", control= rpart.control(cp=0))
#loan_model <- rpart(pm2.5 ~day+hour+DEWP+TEMP+PRES)
loan_model <- rpart(pm2.5 ~., data=train_data, method="class", control= rpart.control(cp=0))
View(loan_model)
loan_model
